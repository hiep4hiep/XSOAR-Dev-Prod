category: Data Enrichment & Threat Intelligence
commonfields:
  id: Sixgill_Darkfeed_Enrichment
  version: -1
configuration:
- display: Sixgill API client ID
  name: client_id
  required: true
  type: 0
- display: Sixgill API client secret
  name: client_secret
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.5.0
    itemVersion: 2.0.7
    packID: Sixgill-Darkfeed
    packPropagationLabels:
    - all
    propagationLabels: []
    remote: true
    toServerVersion: ""
description: Sixgill Darkfeed Enrichment – powered by the broadest automated collection
  from the deep and dark web – is the most comprehensive IOC enrichment solution on
  the market. By enriching Palo Alto Networks Cortex XSOAR IOCs with Darkfeed, customers
  gain unparalleled context and essential explanations in order to accelerate their
  incident prevention and response and stay ahead of the threat curve. Automatically
  enrich Cortex XSOAR IOCs (machine to machine) via Darkfeed. Block threats and enrich
  endpoint protection in real-time from the Cortex XSOAR dashboard, gain contextual
  and actionable insights with essential explanations of Cortex XSOAR IOCs.
detaileddescription: |-
  ### Partner Contributed Integration
  #### Integration Author: Cybersixgill
  Support and maintenance for this integration are provided by the author. Please use the following contact details:
  - **Email**: [sales@cybersixgill.com](mailto:sales@cybersixgill.com)
  ***
   ## Configure an API account
  To configure an instance of Sixgill's integration in XSOAR, you need to supply your API key and client secret. Contact sales@cybersixgill.com to receive these or purchase the integration through XSOAR marketplace.



  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/sixgill-darkfeed-enrichment)
display: Sixgill DarkFeed Enrichment (Partner Contribution)
image: data:image/png;base64,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
name: Sixgill_Darkfeed_Enrichment
script:
  commands:
  - arguments:
    - default: true
      description: A comma-separated list of IPs to check.
      isArray: true
      name: ip
      required: true
    - defaultValue: "0"
      description: The number of outputs per indicator to be skipped when returning
        the result set. Default is 0.
      name: skip
    description: Returns information and a reputation for each IP in the input list.
    name: ip
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the indicator score.
      type: String
    - contextPath: SixgillDarkfeed.IP.created
      description: The timestamp when the indicator was created.
      type: Date
    - contextPath: SixgillDarkfeed.IP.id
      description: The unique ID of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.IP.description
      description: The description of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.IP.lang
      description: The language of the original post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.IP.modified
      description: The timestamp when the indicator was last modified.
      type: Date
    - contextPath: SixgillDarkfeed.IP.pattern
      description: The indicator IP address.
      type: String
    - contextPath: SixgillDarkfeed.IP.sixgill_actor
      description: The actor of the original post on the dark web.
      type: String
    - contextPath: SixgillDarkfeed.IP.sixgill_confidence
      description: The indicator confidence score.
      type: Number
    - contextPath: SixgillDarkfeed.IP.sixgill_feedid
      description: The indicator subfeed ID.
      type: String
    - contextPath: SixgillDarkfeed.IP.sixgill_feedname
      description: The indicator subfeed name.
      type: String
    - contextPath: SixgillDarkfeed.IP.sixgill_postid
      description: The ID of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.IP.sixgill_posttitle
      description: The title of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.IP.sixgill_severity
      description: The indicator severity score.
      type: Number
    - contextPath: SixgillDarkfeed.IP.sixgill_source
      description: The source of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.IP.spec_version
      description: The STIX specification version.
      type: String
    - contextPath: SixgillDarkfeed.IP.type
      description: The STIX object type.
      type: String
    - contextPath: SixgillDarkfeed.IP.valid_from
      description: The creation date of the post in the Sixgill portal.
      type: Date
    - contextPath: SixgillDarkfeed.IP.labels
      description: The indicative labels of the indicator.
      type: Unknown
    - contextPath: SixgillDarkfeed.IP.external_reference
      description: Link to the IOC on VirusTotal and an abstraction of the number
        of detections; MITRE ATT&CK tactics and techniques.
      type: Unknown
    - contextPath: IP.Address
      description: The indicator IP address.
      type: String
  - arguments:
    - default: true
      description: A comma-separated list of domain names to check.
      isArray: true
      name: domain
      required: true
    - defaultValue: "0"
      description: The number of outputs per indicator to be skipped when returning
        the result set. Default is 0.
      name: skip
    description: Returns information and a reputation for each domain name in the
      input list.
    name: domain
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the indicator score.
      type: String
    - contextPath: SixgillDarkfeed.Domain.created
      description: The timestamp when the indicator was created.
      type: Date
    - contextPath: SixgillDarkfeed.Domain.id
      description: The unique ID of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.Domain.description
      description: The description of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.Domain.lang
      description: The language of the original post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Domain.modified
      description: The timestamp when the indicator was last modified.
      type: Date
    - contextPath: SixgillDarkfeed.Domain.pattern
      description: The indicator domain name.
      type: String
    - contextPath: SixgillDarkfeed.Domain.sixgill_actor
      description: The actor of the original post on the dark web.
      type: String
    - contextPath: SixgillDarkfeed.Domain.sixgill_confidence
      description: The indicator confidence score.
      type: Number
    - contextPath: SixgillDarkfeed.Domain.sixgill_feedid
      description: The indicator subfeed ID.
      type: String
    - contextPath: SixgillDarkfeed.Domain.sixgill_feedname
      description: The indicator subfeed name.
      type: String
    - contextPath: SixgillDarkfeed.Domain.sixgill_postid
      description: The ID of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Domain.sixgill_posttitle
      description: The title of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Domain.sixgill_severity
      description: The indicator severity score.
      type: Number
    - contextPath: SixgillDarkfeed.Domain.sixgill_source
      description: The source of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Domain.spec_version
      description: The STIX specification version.
      type: String
    - contextPath: SixgillDarkfeed.Domain.type
      description: The STIX object type.
      type: String
    - contextPath: SixgillDarkfeed.Domain.valid_from
      description: The creation date of the post in the Sixgill portal.
      type: Date
    - contextPath: SixgillDarkfeed.Domain.labels
      description: The indicative labels of the indicator.
      type: Unknown
    - contextPath: SixgillDarkfeed.Domain.external_reference
      description: Link to the IOC on Virustotal and an abstraction of the number
        of detections; MITRE ATT&CK tactics and techniques.
      type: Unknown
    - contextPath: Domain.Name
      description: The indicator domain name.
      type: String
  - arguments:
    - default: true
      description: A comma-separated list of URLs to check.
      isArray: true
      name: url
      required: true
    - defaultValue: "0"
      description: The number of outputs per indicator to be skipped when returning
        the result set. Default is 0.
      name: skip
    description: Returns information and a reputation for each URL in the input list.
    name: url
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the indicator score.
      type: String
    - contextPath: SixgillDarkfeed.URL.created
      description: The timestamp when the indicator was created.
      type: Date
    - contextPath: SixgillDarkfeed.URL.id
      description: The unique ID of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.URL.description
      description: The description of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.URL.lang
      description: The language of the original post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.URL.modified
      description: The timestamp when the indicator was last modified.
      type: Date
    - contextPath: SixgillDarkfeed.URL.pattern
      description: The indicator URL.
      type: String
    - contextPath: SixgillDarkfeed.URL.sixgill_actor
      description: The actor of the original post on the dark web.
      type: String
    - contextPath: SixgillDarkfeed.URL.sixgill_confidence
      description: The indicator confidence score.
      type: Number
    - contextPath: SixgillDarkfeed.URL.sixgill_feedid
      description: The indicator subfeed ID.
      type: String
    - contextPath: SixgillDarkfeed.URL.sixgill_feedname
      description: The indicator subfeed name.
      type: String
    - contextPath: SixgillDarkfeed.URL.sixgill_postid
      description: The ID of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.URL.sixgill_posttitle
      description: The title of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.URL.sixgill_severity
      description: The indicator severity score.
      type: Number
    - contextPath: SixgillDarkfeed.URL.sixgill_source
      description: The source of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.URL.spec_version
      description: The STIX specification version.
      type: String
    - contextPath: SixgillDarkfeed.URL.type
      description: The STIX object type.
      type: String
    - contextPath: SixgillDarkfeed.URL.valid_from
      description: The creation date of the post in the Sixgill portal.
      type: Date
    - contextPath: SixgillDarkfeed.URL.labels
      description: The indicative labels of the indicator.
      type: Unknown
    - contextPath: URL.Data
      description: The indicator URL.
      type: string
    - contextPath: SixgillDarkfeed.URL.external_reference
      description: Link to the IOC on Virustotal and an abstraction of the number
        of detections; MITRE ATT&CK tactics and techniques.
      type: Unknown
  - arguments:
    - default: true
      description: A comma-separated list of file hashes to check.
      isArray: true
      name: file
      required: true
    - defaultValue: "0"
      description: The number of outputs per indicator to be skipped when returning
        the result set. Default is 0.
      name: skip
    description: Returns information and a reputation for each file hash in the input
      list.
    name: file
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the indicator score.
      type: String
    - contextPath: SixgillDarkfeed.File.created
      description: The timestamp when the indicator was created.
      type: Date
    - contextPath: SixgillDarkfeed.File.id
      description: The unique ID of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.File.description
      description: The description of the indicator.
      type: String
    - contextPath: SixgillDarkfeed.File.lang
      description: The language of the original post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.File.modified
      description: The timestamp when the indicator was last modified.
      type: Date
    - contextPath: SixgillDarkfeed.File.pattern
      description: The indicator file hash (hashes include MD5, SHA-1 and SHA-256
        when possible).
      type: String
    - contextPath: SixgillDarkfeed.File.sixgill_actor
      description: The actor of the original post on the dark web.
      type: String
    - contextPath: SixgillDarkfeed.File.sixgill_confidence
      description: The indicator confidence score.
      type: Number
    - contextPath: SixgillDarkfeed.File.sixgill_feedid
      description: The indicator subfeed ID.
      type: String
    - contextPath: SixgillDarkfeed.File.sixgill_feedname
      description: The indicator subfeed name.
      type: String
    - contextPath: SixgillDarkfeed.File.sixgill_postid
      description: The ID of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.File.sixgill_posttitle
      description: The title of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.File.sixgill_severity
      description: The indicator severity score.
      type: Number
    - contextPath: SixgillDarkfeed.File.sixgill_source
      description: The source of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.File.spec_version
      description: The STIX specification version.
      type: String
    - contextPath: SixgillDarkfeed.File.type
      description: The STIX object type.
      type: String
    - contextPath: SixgillDarkfeed.File.valid_from
      description: The creation date of the post in the Sixgill portal.
      type: Date
    - contextPath: SixgillDarkfeed.File.labels
      description: The indicative labels of the indicator.
      type: Unknown
    - contextPath: SixgillDarkfeed.File.external_reference
      description: Link to the IOC on Virustotal and an abstraction of the number
        of detections; MITRE ATT&CK tactics and techniques.
      type: Unknown
    - contextPath: File.SHA256
      description: The SHA256 file hash.
      type: string
    - contextPath: File.SHA512
      description: The SHA512 file hash.
      type: string
    - contextPath: File.SHA1
      description: The SHA1 file hash.
      type: string
    - contextPath: File.MD5
      description: The MD5 file hash.
      type: string
  - arguments:
    - default: true
      description: A comma-separated list of actors to check.
      isArray: true
      name: actor
      required: true
    - defaultValue: "0"
      description: The number of outputs per actor to be skipped when returning the
        result set. Default is 0.
      name: skip
    description: Returns information and a reputation for each actor in the input
      list.
    name: sixgill-get-actor
    outputs:
    - contextPath: SixgillDarkfeed.Actor.created
      description: The timestamp when the actor shared their first IOC.
      type: Date
    - contextPath: SixgillDarkfeed.Actor.id
      description: The unique ID of the actor.
      type: String
    - contextPath: SixgillDarkfeed.Actor.description
      description: The description of the actor.
      type: String
    - contextPath: SixgillDarkfeed.Actor.lang
      description: The language of the original post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Actor.modified
      description: The timestamp when the actor was last modified.
      type: Date
    - contextPath: SixgillDarkfeed.Actor.pattern
      description: A list of the IOCs shared by the actor.
      type: String
    - contextPath: SixgillDarkfeed.Actor.sixgill_actor
      description: The actor of the original post on the dark web.
      type: String
    - contextPath: SixgillDarkfeed.Actor.sixgill_confidence
      description: The confidence score of the actor.
      type: Number
    - contextPath: SixgillDarkfeed.Actor.sixgill_feedid
      description: The Subfeed ID of the actor.
      type: String
    - contextPath: SixgillDarkfeed.Actor.sixgill_feedname
      description: The Subfeed name of the actor.
      type: String
    - contextPath: SixgillDarkfeed.Actor.sixgill_postid
      description: The ID of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Actor.sixgill_posttitle
      description: The title of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Actor.sixgill_severity
      description: The severity score of the actor.
      type: Number
    - contextPath: SixgillDarkfeed.Actor.sixgill_source
      description: The source of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Actor.spec_version
      description: The STIX specification version.
      type: String
    - contextPath: SixgillDarkfeed.Actor.type
      description: The STIX object type.
      type: String
    - contextPath: SixgillDarkfeed.Actor.valid_from
      description: The creation date of the post in the Sixgill portal.
      type: Date
    - contextPath: SixgillDarkfeed.Actor.labels
      description: The indicative labels of the actor.
      type: Unknown
    - contextPath: SixgillDarkfeed.Actor.external_reference
      description: Link to the IOC on Virustotal and an abstraction of the number
        of detections; MITRE ATT&CK tactics and techniques.
      type: Unknown
  - arguments:
    - default: true
      description: A comma-separated list of post IDs to check.
      isArray: true
      name: post_id
      required: true
    - defaultValue: "0"
      description: The number of outputs per post ID to be skipped when returning
        the result set. Default is 0.
      name: skip
    description: Returns information and a reputation for each post ID in the input
      list.
    name: sixgill-get-post-id
    outputs:
    - contextPath: SixgillDarkfeed.Postid.created
      description: The timestamp when an IOC was first included in the post.
      type: Date
    - contextPath: SixgillDarkfeed.Postid.id
      description: The unique ID of the post.
      type: String
    - contextPath: SixgillDarkfeed.Postid.description
      description: The description of the post ID.
      type: String
    - contextPath: SixgillDarkfeed.Postid.lang
      description: The language of the original post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Postid.modified
      description: The timestamp when the post ID information was last modified.
      type: Date
    - contextPath: SixgillDarkfeed.Postid.pattern
      description: A list of the IOCs included in the post.
      type: String
    - contextPath: SixgillDarkfeed.Postid.sixgill_actor
      description: The actor of the original post on the dark web.
      type: String
    - contextPath: SixgillDarkfeed.Postid.sixgill_confidence
      description: The confidence score of the post ID.
      type: Number
    - contextPath: SixgillDarkfeed.Postid.sixgill_feedid
      description: The Subfeed ID of the post ID.
      type: String
    - contextPath: SixgillDarkfeed.Postid.sixgill_feedname
      description: The Subfeed name of the post ID.
      type: String
    - contextPath: SixgillDarkfeed.Postid.sixgill_postid
      description: The ID of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Postid.sixgill_posttitle
      description: The title of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Postid.sixgill_severity
      description: The severity score of the post ID.
      type: Number
    - contextPath: SixgillDarkfeed.Postid.sixgill_source
      description: The source of the post in the Sixgill portal.
      type: String
    - contextPath: SixgillDarkfeed.Postid.spec_version
      description: The STIX specification version.
      type: String
    - contextPath: SixgillDarkfeed.Postid.type
      description: The STIX object type.
      type: String
    - contextPath: SixgillDarkfeed.Postid.valid_from
      description: The creation date of the post in the Sixgill portal.
      type: Date
    - contextPath: SixgillDarkfeed.Postid.labels
      description: The indicative labels of the post ID.
      type: Unknown
    - contextPath: SixgillDarkfeed.Postid.external_reference
      description: Link to the IOC on Virustotal and an abstraction of the number
        of detections; MITRE ATT&CK tactics and techniques.
      type: Unknown
  dockerimage: demisto/sixgill:1.0.0.23434
  runonce: false
  script: |2




    """ IMPORTS """

    from typing import Dict, List, Any
    import traceback
    import requests

    from sixgill.sixgill_request_classes.sixgill_auth_request import SixgillAuthRequest
    from sixgill.sixgill_enrich_client import SixgillEnrichClient

    # Disable insecure warnings
    requests.packages.urllib3.disable_warnings()

    hashes: Dict[str, Any] = {}


    def to_demisto_score(feed_id: str, revoked: bool):
        suspicious_feed_ids = ["darkfeed_003"]
        if revoked:
            return Common.DBotScore.NONE  # unknown
        if feed_id in suspicious_feed_ids:
            return Common.DBotScore.SUSPICIOUS  # suspicious
        return Common.DBotScore.BAD  # bad


    """ COMMANDS + REQUESTS FUNCTIONS """


    def test_module_command(client_id, client_secret, channel_code, session, verify):
        """
        Performs basic Auth request
        """
        response = session.send(
            request=SixgillAuthRequest(
                client_id, client_secret, channel_code
            ).prepare(),
            verify=verify,
        )
        if not response.ok:
            raise Exception("Auth request failed - please verify client_id, and client_secret.")
        return "ok"


    def get_score(indicator):
        return to_demisto_score(indicator.get("sixgill_feedid"), indicator.get("revoke", False))


    def get_file_hashes(indicators: list = []):
        for indicator in indicators:
            process_file_hashes(indicator, demisto)
        return hashes


    def process_file_hashes(stix2obj: Dict[str, Any], log):
        """
        Get the file hashes from indicator
        """
        pattern = stix2obj.get("pattern", "")
        hash_mapping = {
            "hashes.md5": "md5",
            "hashes.'sha-1'": "sha1",
            "hashes.'sha-256'": "sha256",
            "hashes.'sha-512'": "sha512",
            "hashes.ssdeep": "ssdeep",
        }

        stix_regex_parser = re.compile(r"([\w-]+?):(\w.+?) (?:[!><]?=|IN|MATCHES|LIKE) '(.*?)' *[OR|AND|FOLLOWEDBY]?")

        for match in stix_regex_parser.findall(pattern):
            try:
                _, sub_type, value = match
                if hash_mapping[sub_type.lower()] not in hashes:
                    hashes[hash_mapping[sub_type.lower()]] = value

            except Exception as e:
                log.error(f"failed to get file hashes from: {e}, STIX object: {stix2obj}")
                continue
        return hashes


    def ip_reputation_command(client: SixgillEnrichClient, args) -> List[CommandResults]:
        ips = argToList(args.get("ip"))
        skip = int(args.get("skip"))

        if len(ips) == 0:
            raise ValueError("IP(s) not specified")

        command_results: List[CommandResults] = []

        for ip in ips:
            ip_data = client.enrich_ioc("ip", ip, skip)

            score = 0
            if len(ip_data) != 0:
                score = max(list(map(get_score, ip_data)))

            dbot_score = Common.DBotScore(
                indicator=ip, indicator_type=DBotScoreType.IP, integration_name="SixgillDarkfeedEnrichment", score=score,
                malicious_description="; ".join({ioc.get("description") for ioc in ip_data})
            )

            ip_standard_context = Common.IP(ip=ip, dbot_score=dbot_score)

            readable_output = tableToMarkdown("IP", ip_data)

            command_results.append(
                CommandResults(
                    readable_output=readable_output,
                    outputs_prefix="Sixgill.IP",
                    outputs_key_field="ip",
                    outputs=ip_data,
                    indicator=ip_standard_context,
                )
            )
        return command_results


    def domain_reputation_command(client: SixgillEnrichClient, args) -> List[CommandResults]:
        domains = argToList(args.get("domain"))
        skip = int(args.get("skip"))

        if len(domains) == 0:
            raise ValueError("DOMAIN(s) not specified")

        command_results: List[CommandResults] = []

        for domain in domains:
            domain_data = client.enrich_ioc("domain", domain, skip)

            score = 0
            if len(domain_data) != 0:
                score = max(list(map(get_score, domain_data)))

            dbot_score = Common.DBotScore(
                indicator=domain,
                indicator_type=DBotScoreType.DOMAIN,
                integration_name="SixgillDarkfeedEnrichment",
                score=score,
                malicious_description="; ".join({ioc.get("description") for ioc in domain_data})
            )

            domain_standard_context = Common.Domain(domain=domain, dbot_score=dbot_score)

            readable_output = tableToMarkdown("Domain", domain_data)

            command_results.append(
                CommandResults(
                    readable_output=readable_output,
                    outputs_prefix="Sixgill.Domain",
                    outputs_key_field="domain",
                    outputs=domain_data,
                    indicator=domain_standard_context,
                )
            )
        return command_results


    def url_reputation_command(client: SixgillEnrichClient, args) -> List[CommandResults]:
        urls = argToList(args.get("url"))
        skip = int(args.get("skip"))

        if len(urls) == 0:
            raise ValueError("URL(s) not specified")

        command_results: List[CommandResults] = []

        for url in urls:
            url_data = client.enrich_ioc("url", url, skip)

            score = 0
            if len(url_data) != 0:
                score = max(list(map(get_score, url_data)))

            dbot_score = Common.DBotScore(
                indicator=url, indicator_type=DBotScoreType.URL, integration_name="SixgillDarkfeedEnrichment", score=score,
                malicious_description="; ".join({ioc.get("description") for ioc in url_data})
            )

            url_standard_context = Common.URL(url=url, dbot_score=dbot_score)

            readable_output = tableToMarkdown("URL", url_data)

            command_results.append(
                CommandResults(
                    readable_output=readable_output,
                    outputs_prefix="Sixgill.URL",
                    outputs_key_field="url",
                    outputs=url_data,
                    indicator=url_standard_context,
                )
            )
        return command_results


    def file_reputation_command(client: SixgillEnrichClient, args) -> List[CommandResults]:
        files = argToList(args.get("file"))
        skip = int(args.get("skip"))

        if len(files) == 0:
            raise ValueError("HASH(s) not specified")

        command_results: List[CommandResults] = []

        for file_hash in files:
            file_data = client.enrich_ioc("hash", file_hash, skip)

            score = 0
            if len(file_data) != 0:
                score = max(list(map(get_score, file_data)))

            file_hash_types = get_file_hashes(file_data)

            dbot_score = Common.DBotScore(
                indicator=file_hash,
                indicator_type=DBotScoreType.FILE,
                integration_name="SixgillDarkfeedEnrichment",
                score=score,
                malicious_description="; ".join({ioc.get("description") for ioc in file_data})
            )

            file_standard_context = Common.File(
                md5=file_hash_types.get("md5"),
                sha256=file_hash_types.get("sha256"),
                sha1=file_hash_types.get("sha1"),
                sha512=file_hash_types.get("sha512"),
                ssdeep=file_hash_types.get("ssdeep"),
                dbot_score=dbot_score,
            )

            readable_output = tableToMarkdown("File", file_data)

            command_results.append(
                CommandResults(
                    readable_output=readable_output,
                    outputs_prefix="Sixgill.File",
                    outputs_key_field="file",
                    outputs=file_data,
                    indicator=file_standard_context,
                )
            )
        return command_results


    def actor_reputation_command(client: SixgillEnrichClient, args) -> List[CommandResults]:
        actors = argToList(args.get("actor"))
        skip = int(args.get("skip"))

        if len(actors) == 0:
            raise ValueError("ACTOR(s) not specified")

        command_results: List[CommandResults] = []

        for actor in actors:
            actor_data = client.enrich_actor(actor, skip)

            readable_output = tableToMarkdown("Actor", actor_data)

            command_results.append(
                CommandResults(
                    readable_output=readable_output,
                    outputs_prefix="Sixgill.Actor",
                    outputs_key_field="actor",
                    outputs=actor_data,
                )
            )
        return command_results


    def postid_reputation_command(client: SixgillEnrichClient, args) -> List[CommandResults]:
        postids = argToList(args.get("post_id"))
        skip = int(args.get("skip"))

        if len(postids) == 0:
            raise ValueError("POSTID(s) not specified")

        command_results: List[CommandResults] = []

        for post_id in postids:
            post_id_data = client.enrich_postid(post_id, skip)

            readable_output = tableToMarkdown("Postid", post_id_data)

            command_results.append(
                CommandResults(
                    readable_output=readable_output,
                    outputs_prefix="Sixgill.Postid",
                    outputs_key_field="postid",
                    outputs=post_id_data,
                )
            )
        return command_results


    """ COMMANDS MANAGER / SWITCH PANEL """


    def main():
        channel_code = "7698e8287dfde53dcd13082be750a85a"

        verify = not demisto.params().get("insecure", True)
        session = requests.Session()

        session.proxies = handle_proxy()

        client = SixgillEnrichClient(
            demisto.params()["client_id"], demisto.params()["client_secret"], channel_code, demisto, session, verify
        )

        command = demisto.command()
        demisto.info(f"Command being called is {command}")

        try:
            if command == "ip":
                return_results(ip_reputation_command(client, demisto.args()))

            elif command == "test-module":
                return_results(
                    test_module_command(demisto.params()["client_id"], demisto.params()["client_secret"], channel_code,
                                        session, verify))

            elif command == "domain":
                return_results(domain_reputation_command(client, demisto.args()))

            elif command == "url":
                return_results(url_reputation_command(client, demisto.args()))

            elif command == "file":
                return_results(file_reputation_command(client, demisto.args()))

            elif command == "sixgill-get-actor":
                return_results(actor_reputation_command(client, demisto.args()))

            elif command == "sixgill-get-post-id":
                return_results(postid_reputation_command(client, demisto.args()))

        except Exception as e:
            demisto.error(traceback.format_exc())
            return_error(f"Error failed to execute {demisto.command()}, error: [{e}]")


    if __name__ == "__builtin__" or __name__ == "builtins":
        main()
  subtype: python3
  type: python
system: true
