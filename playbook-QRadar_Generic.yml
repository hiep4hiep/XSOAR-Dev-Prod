contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.0.0
    itemVersion: 2.1.34
    packID: QRadar
    packPropagationLabels:
    - all
    propagationLabels: []
    toServerVersion: ""
description: The QRadar Generic playbook is executed for the QRadar Generic incident
  type. It performs all the common parts of the investigation, including notifying
  the SOC, enriching data for indicators and users, calculating severity, assigning
  incidents, and notifying the SIEM admin about false positives.
id: QRadar Generic
inputs:
- description: Determines whether to enrich all indicators in the incident.
  key: Enrich
  playbookInputQuery: null
  required: false
  value:
    simple: "true"
- description: Set to true to assign only the user that is currently on shift. Requires
    Cortex XSOAR v5.5 or later.
  key: OnCall
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
- description: The SOC team's email address.
  key: SocEmailAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: The subject of the email to send to the SOC.
  key: SocMailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: 'XSOAR Summary report, ID - '
- description: The SIEM admin's email address.
  key: SiemAdminEmailAddress
  playbookInputQuery: null
  required: false
  value: {}
- description: Determines whether to use the Calculate Severity playbook to calculate
    the incident severity. If the playbook isn't used, the severity is determined
    by the QRadar magnitude value.
  key: UseCalculateSeverity
  playbookInputQuery: null
  required: false
  value:
    simple: "true"
- description: The subject of the email to send to the SIEM admin.
  key: SiemAdminMailSubject
  playbookInputQuery: null
  required: false
  value:
    simple: 'Adjustment/Exclusion for offense '
- description: Determines whether to use the default mapping in the QRadar generic
    mapper to set the XSOAR incident severity, or set the severity using the FieldToSetSeverityFrom
    and ScaleToSetSeverityFrom playbook inputs. Any value other than false is considered
    as true and causes the playbook inputs to be used.
  key: UseCustomSeveritySettings
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
- description: |
    Specifies the field to use for calculating the incident severity, for example the severity field.
  key: FieldToSetSeverityFrom
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: magnitudeoffense
      root: incident
- description: "The range of values of FieldToSetSeverityFrom is 1-10. The XSOAR incident
    severity field value range is 0-4 where\n0 - Informational\n1 - Low\n2 - Medium\n3
    - High\n4 - Critical\n\nThe scale translates the value of FieldToSetSeverityFrom
    to a valid incident severity value. The default scale is 1,1,1,2,2,2,2,3,3,3 \nThis
    means that values 1-3 of FieldToSetSeverityFrom are translated to low severity
    (positions 1-3 in the scale), values 4-7 are translated to medium severity (positions
    4-7 in the scale) and values 8-10 are translated to high severity (positions 8-10
    in the scale)."
  key: ScaleToSetSeverityFrom
  playbookInputQuery: null
  required: false
  value:
    simple: 1,1,1,2,2,2,2,3,3,3
- description: By default the incident fetches the events defined in the integration
    instance settings (default is 20 events). To fetch additional events, change this
    setting to true.
  key: RunAdditionalSeach
  playbookInputQuery: null
  required: false
  value:
    simple: "true"
- description: Maximum number of log entires to query from QRadar. Used for the QRadar
    - Get Offense Logs subplaybook.
  key: MaxLogsCount
  playbookInputQuery: null
  required: false
  value:
    simple: "50"
- description: |
    If this value is "OnlyCRE", get only events made by CRE. Values can be "OnlyCRE", "OnlyNotCRE", "All". Used for the QRadar - Get Offense Logs subplaybook.
  key: GetOnlyCREEvents
  playbookInputQuery: null
  required: false
  value:
    simple: All
- description: |
    A comma-separated list of extra fields to get from each event. You can use different fields or rename the existing fields. Used for the QRadar - Get Offense Logs subplaybook.
  key: Fields
  playbookInputQuery: null
  required: false
  value:
    simple: QIDNAME(qid), LOGSOURCENAME(logsourceid), CATEGORYNAME(highlevelcategory),
      CATEGORYNAME(category), PROTOCOLNAME(protocolid), sourceip, sourceport, destinationip,
      destinationport, QIDDESCRIPTION(qid), username, PROTOCOLNAME(protocolid), RULENAME("creEventList"),
      sourcegeographiclocation, sourceMAC, sourcev6, destinationgeographiclocation,
      destinationv6, LOGSOURCETYPENAME(devicetype), credibility, severity, magnitude,
      eventcount, eventDirection, postNatDestinationIP, postNatDestinationPort, postNatSourceIP,
      postNatSourcePort, preNatDestinationPort, preNatSourceIP, preNatSourcePort,
      UTF8(payload), starttime, devicetime
- description: The tag to provide for true positive indicators, for example to use
    the indicators in an EDL (External Dynamic List).
  key: IndicatorTag
  playbookInputQuery: null
  required: false
  value:
    simple: block
- description: If this value is not false, add indicators to the XSOAR exclude list.
    The excluded indicators won't be created in XSOAR anymore.
  key: ExcludeIndicatorsInXSOAR
  playbookInputQuery: null
  required: false
  value:
    simple: "false"
name: QRadar Generic
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 08854949-08a5-4873-8f01-b3935c78675f
      iscommand: false
      name: ""
      version: -1
    taskid: 08854949-08a5-4873-8f01-b3935c78675f
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1920
        }
      }
  "1":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: inputs.Enrich
          operator: isEqualString
          right:
            value:
              simple: "True"
      label: "yes"
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "3"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks whether the Enrich playbook input is set to True.
      id: a04c8331-e7c5-4107-8605-b6ee82d4639d
      iscommand: false
      name: Should indicators be extracted and enriched?
      type: condition
      version: -1
    taskid: a04c8331-e7c5-4107-8605-b6ee82d4639d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1105
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assigns a random analyst to this incident.
      id: c74d18c6-9939-4701-828f-149cddba2b8d
      iscommand: false
      name: Start Remediation SLA Timer
      type: title
      version: -1
    taskid: c74d18c6-9939-4701-828f-149cddba2b8d
    timertriggers:
    - action: start
      fieldname: remediationsla
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": -110
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "9"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: aca20665-33d5-4e20-866b-0b8f73cd90fc
      iscommand: false
      name: Enrich Data
      type: title
      version: -1
    taskid: aca20665-33d5-4e20-866b-0b8f73cd90fc
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -920
        }
      }
  "7":
    form:
      description: Provide notes regarding the investigation.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Investigation Notes
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: longText
      sender: ""
      title: Investigation Notes
      totalanswers: 0
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Manually review and investigate this incident.
      id: e3efbacf-f8e3-4291-8ab7-459037ce9a64
      iscommand: false
      name: Manually review the incident
      type: collection
      version: -1
    taskid: e3efbacf-f8e3-4291-8ab7-459037ce9a64
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 210,
          "y": 395
        }
      }
  "8":
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      closeNotes:
        simple: |-
          Closed By: ${Investigation Notes.Answers.name}
          ${Investigation Notes.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Closes the current incident.
      id: 4b1a5788-3cef-4857-8023-dcd01dfa8793
      iscommand: true
      name: Close investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 4b1a5788-3cef-4857-8023-dcd01dfa8793
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3740
        }
      }
  "9":
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    reputationcalc: 2
    scriptarguments:
      text:
        complex:
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Extracts all indicators from the incident and enriches the indicators
        by using the reputation command defined for each indicator type.
      id: 354e53b0-0132-44d6-895e-0f6e0a248cd9
      iscommand: true
      name: Extract indicators from incident
      script: Builtin|||extractIndicators
      type: regular
      version: -1
    taskid: 354e53b0-0132-44d6-895e-0f6e0a248cd9
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -790
        }
      }
  "10":
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: e6df7983-dd60-487d-8fce-70f7f5766175
      iscommand: false
      name: Entity Enrichment - Generic v2
      playbookId: Entity Enrichment - Generic v2
      type: playbook
      version: -1
    taskid: e6df7983-dd60-487d-8fce-70f7f5766175
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -630
        }
      }
  "12":
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: de6f9320-320d-4bd6-820f-b612a7a0c2c7
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: de6f9320-320d-4bd6-820f-b612a7a0c2c7
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3880
        }
      }
  "13":
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "8"
    note: false
    quietmode: 0
    scriptarguments:
      attachIDs:
        complex:
          accessor: EntryID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: InfoFile.Name
              operator: containsGeneral
              right:
                value:
                  simple: report_Investigation_Summary
          root: InfoFile
      body:
        complex:
          accessor: investigation}
          root: ${demistoUrls
          transformers:
          - args:
              prefix:
                value:
                  simple: |
                    Link to the incident
              suffix: {}
            operator: concat
      subject:
        complex:
          root: inputs.SocMailSubject
          transformers:
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.id
            operator: concat
      to:
        simple: ${inputs.SocEmailAddress}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Sends an email using EWS.
      id: fd2276ce-b8ca-43f2-8d91-1ad091484e27
      iscommand: true
      name: Send investigation report to SOC
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: fd2276ce-b8ca-43f2-8d91-1ad091484e27
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -110,
          "y": 3570
        }
      }
  "14":
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      False Positive:
      - "29"
      True Positive:
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b3aae31-8d82-401d-87cf-d0148d0b278b
      iscommand: false
      name: Was this a true positive?
      type: condition
      version: -1
    taskid: 1b3aae31-8d82-401d-87cf-d0148d0b278b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1540
        }
      }
  "15":
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "17"
    note: false
    quietmode: 0
    scriptarguments:
      incidentId:
        complex:
          accessor: id
          root: incident
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        A script to generate the investigation summary report automatically
        can be used in the post-processing flow as well.
      id: ff1b9850-ef10-4d42-80e3-39b72d8d01f8
      iscommand: false
      name: Generate Investigation Summary Report
      script: GenerateInvestigationSummaryReport
      type: regular
      version: -1
    taskid: ff1b9850-ef10-4d42-80e3-39b72d8d01f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 220,
          "y": 2880
        }
      }
  "16":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.UseCalculateSeverity
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b419c44d-1762-4553-8493-f9d7606af7bc
      iscommand: false
      name: Use Calculate Severity?
      type: condition
      version: -1
    taskid: b419c44d-1762-4553-8493-f9d7606af7bc
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 562.5,
          "y": -450
        }
      }
  "17":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SocEmailAddress
          operator: isNotEmpty
      label: "yes"
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "31"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 670d8449-b528-465d-8b3f-6e22cda63229
      iscommand: false
      name: Was the SOC email address provided?
      type: condition
      version: -1
    taskid: 670d8449-b528-465d-8b3f-6e22cda63229
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 220,
          "y": 3030
        }
      }
  "18":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.SiemAdminEmailAddress
          operator: isNotEmpty
      label: "yes"
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "30"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 355b3075-9035-4285-82b0-c4d63679b10c
      iscommand: false
      name: Was the SIEM admin email address provided?
      type: condition
      version: -1
    taskid: 355b3075-9035-4285-82b0-c4d63679b10c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2040
        }
      }
  "19":
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      assignBy:
        simple: random
      onCall:
        complex:
          root: inputs.OnCall
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Assigns a random analyst to this incident.
      id: 0c7b3033-c209-4a87-8ef5-63fbd907f68d
      iscommand: false
      name: Assign an analyst to the incident
      script: AssignAnalystToIncident
      type: regular
      version: -1
    taskid: 0c7b3033-c209-4a87-8ef5-63fbd907f68d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 215
        }
      }
  "20":
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 381f98db-b60a-4514-89d8-959cd9189cb3
      iscommand: false
      name: Post Incident Activity
      type: title
      version: -1
    taskid: 381f98db-b60a-4514-89d8-959cd9189cb3
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 560
        }
      }
  "22":
    form:
      description: Provide what should be adjusted in the rule
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Which rules need to be adjusted?
        options: []
        optionsarg:
        - {}
        - simple: ${incident.listofrulesoffense}
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Which indicators need to be excluded in QRadar?
        options: []
        optionsarg:
        - {}
        - complex:
            root: ExtractedIndicators
            transformers:
            - args:
                field:
                  value:
                    simple: Domain
              operator: getField
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.Email
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Data for rule adjustment by the SIEM admin
      totalanswers: 0
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provide data to adjust the rule in order to avoid similar false
        positives in the future.
      id: 4dfa75fe-917f-4eed-894a-3f2dfda362fc
      iscommand: false
      name: Provide data for rule adjustment
      type: collection
      version: -1
    taskid: 4dfa75fe-917f-4eed-894a-3f2dfda362fc
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1870
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      severity:
        complex:
          root: inputs.FieldToSetSeverityFrom
          transformers:
          - args:
              input_values:
                value:
                  simple: 1,2,3,4,5,6,7,8,9,10
              mapped_values:
                iscontext: true
                value:
                  simple: inputs.ScaleToSetSeverityFrom
            operator: MapValuesTransformer
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Sets the incident severity according to the FieldToSetSeverityFrom
        and ScaleToSetSeverityFrom playbook inputs, which specify the relevant offense
        field and the scale for the severity translation.
      id: 8873fc30-eabd-4137-8f78-8ba80684a2a0
      iscommand: true
      name: Determine incident severity according to offense info
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: 8873fc30-eabd-4137-8f78-8ba80684a2a0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -20,
          "y": -1620
        }
      }
  "28":
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 226309cb-824c-486f-8b8a-f977f03bba67
      iscommand: false
      name: Investigation
      type: title
      version: -1
    taskid: 226309cb-824c-486f-8b8a-f977f03bba67
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 60
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: False Positive
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Sets the incident status as false positive.
      id: d8d79caa-94a4-4f02-8bda-d306a1357b34
      iscommand: true
      name: Set as false positive
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: d8d79caa-94a4-4f02-8bda-d306a1357b34
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -60,
          "y": 1710
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "23"
      - "15"
      - "52"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 88147dfd-8093-46f6-8a63-5ef810b03328
      iscommand: false
      name: SIEM Admin
      type: title
      version: -1
    taskid: 88147dfd-8093-46f6-8a63-5ef810b03328
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2390
        }
      }
  "31":
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e02854a2-f41b-444b-8953-067035e160ca
      iscommand: false
      name: SOC Summary
      type: title
      version: -1
    taskid: e02854a2-f41b-444b-8953-067035e160ca
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -110,
          "y": 3250
        }
      }
  "32":
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: b6008b80-dc3e-4381-8c5f-5ead8aa3debe
      iscommand: false
      name: Calculate Severity - Standard
      playbookId: Calculate Severity - Standard
      type: playbook
      version: -1
    taskid: b6008b80-dc3e-4381-8c5f-5ead8aa3debe
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 760,
          "y": -280
        }
      }
  "33":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.UseCustomSeveritySettings
          operator: isNotEqualString
          right:
            value:
              simple: "false"
      label: use custom
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "34"
      use custom:
      - "25"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9a80f6b4-18be-413a-8397-794a919efa0b
      iscommand: false
      name: Use custom severity?
      type: condition
      version: -1
    taskid: 9a80f6b4-18be-413a-8397-794a919efa0b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1790
        }
      }
  "34":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.RunAdditionalSeach
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "1"
      "yes":
      - "35"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 359cb86e-fb0e-4a4c-8291-edef6d443ee2
      iscommand: false
      name: Run additional searches?
      type: condition
      version: -1
    taskid: 359cb86e-fb0e-4a4c-8291-edef6d443ee2
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": -1450
        }
      }
  "35":
    id: "35"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      Fields:
        simple: ${inputs.Fields}
      GetOnlyCREEvents:
        simple: ${inputs.GetOnlyCREEvents}
      ID:
        complex:
          accessor: idoffense
          root: incident
      MaxLogsCount:
        simple: ${inputs.MaxLogsCount}
      StartTime:
        complex:
          accessor: starttime
          root: incident
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: "Works for QRadar integrations versions 2 and 3, v1 is deprecated.\n\nNote:
        For QRadar v2 and v3 you can use the integration to fetch the events according
        to the limit defined in the instance settings. Using this playbook you can
        define you can define an additional search to query a larger number of logs.\n\nDefault
        playbook inputs use the QRadar incident fields such as idoffense, starttime.
        These fields can be replaced, but need to point to relevant offense ID and
        starttime fields. "
      id: bb27c52d-e30b-491a-80a8-c20fb7f914dd
      iscommand: false
      name: QRadar - Get Offense Logs
      playbookId: QRadar - Get Offense Logs
      type: playbook
      version: -1
    taskid: bb27c52d-e30b-491a-80a8-c20fb7f914dd
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -20,
          "y": -1280
        }
      }
  "37":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Provide closing reason and tag indicators.Answers
                transformers:
                - operator: count
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "yes"
    id: "37"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "15"
      "yes":
      - "38"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Checks if one number(float) as bigger than the other(float)
        Returns yes: if first > second
        Returns no: if first <= second
        Returns exception if one of the inputs is not a number
      id: 379235d9-c4b9-46c1-81f8-ceac15a2b23a
      iscommand: false
      name: Any indicators to tag?
      type: condition
      version: -1
    taskid: 379235d9-c4b9-46c1-81f8-ceac15a2b23a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 510,
          "y": 2040
        }
      }
  "38":
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      tags:
        simple: ${inputs.IndicatorTag}
      value:
        simple: ${Provide closing reason and tag indicators.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicator
      id: 78b79c26-5204-4982-8530-8cc48542474d
      iscommand: true
      name: Tag Indicators
      script: Builtin|||setIndicator
      type: regular
      version: -1
    taskid: 78b79c26-5204-4982-8530-8cc48542474d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 2700
        }
      }
  "39":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.ExcludeIndicatorsInXSOAR
          operator: isNotEqualString
          right:
            value:
              simple: "false"
      label: "yes"
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 57166b79-05fa-43af-8d85-fa6e622371ca
      iscommand: false
      name: Is Indicator exclusion allowed in XSOAR?
      type: condition
      version: -1
    taskid: 57166b79-05fa-43af-8d85-fa6e622371ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 210,
          "y": 710
        }
      }
  "41":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Indicators to exclude in XSOAR.Answers
                transformers:
                - operator: count
          operator: greaterThan
          right:
            value:
              simple: "0"
      label: "yes"
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "42"
      "yes":
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 511e4e6a-ea30-4ca6-8249-d1a11fc267b3
      iscommand: false
      name: Any indicators to exclude?
      type: condition
      version: -1
    taskid: 511e4e6a-ea30-4ca6-8249-d1a11fc267b3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 0,
          "y": 1030
        }
      }
  "42":
    id: "42"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f6ca219f-b710-403c-8d4b-c9dbc86b607c
      iscommand: false
      name: True/False Positive tuning
      type: title
      version: -1
    taskid: f6ca219f-b710-403c-8d4b-c9dbc86b607c
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 210,
          "y": 1400
        }
      }
  "43":
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "42"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${Indicators to exclude in XSOAR.Answers.0}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.exclude.indicators
      id: f5ef5d8f-37c9-4fe1-8021-f1f49e9cad32
      iscommand: true
      name: Exclude Indicators
      script: Builtin|||excludeIndicators
      type: regular
      version: -1
    taskid: f5ef5d8f-37c9-4fe1-8021-f1f49e9cad32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -170,
          "y": 1220
        }
      }
  "44":
    form:
      description: Provide what should be adjusted in the rule
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Which indicators need to be excluded in XSOAR?
        options: []
        optionsarg:
        - {}
        - complex:
            root: ExtractedIndicators
            transformers:
            - args:
                field:
                  value:
                    simple: Domain
              operator: getField
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.Email
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Indicators to exclude in XSOAR
      totalanswers: 0
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "41"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provide data to adjust the rule in order to avoid similar false
        positives in the future.
      id: 1d1b35bd-3d25-4ffa-839e-b2b4f647bd2c
      iscommand: false
      name: Select indicators to exclude
      type: collection
      version: -1
    taskid: 1d1b35bd-3d25-4ffa-839e-b2b4f647bd2c
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 0,
          "y": 880
        }
      }
  "45":
    form:
      description: Provide what should be adjusted in the rule
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Which indicators need to be tagged? '
        options: []
        optionsarg:
        - {}
        - complex:
            root: ExtractedIndicators
            transformers:
            - args:
                field:
                  value:
                    simple: Domain
              operator: getField
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.IP
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.URL
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.Email
              operator: append
            - args:
                item:
                  iscontext: true
                  value:
                    simple: ExtractedIndicators.File
              operator: append
            - operator: uniq
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: What is the closing reason?
        options: []
        optionsarg: []
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: shortText
      sender: ""
      title: Provide closing reason and tag indicators
      totalanswers: 0
    id: "45"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Provide data to adjust the rule in order to avoid similar false
        positives in the future.
      id: 19cfa6ac-e92f-4950-8a66-e38083737378
      iscommand: false
      name: Provide closing reason and tag indicators
      type: collection
      version: -1
    taskid: 19cfa6ac-e92f-4950-8a66-e38083737378
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1710
        }
      }
  "50":
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "37"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: ${Provide closing reason and tag indicators.Answers.1}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: eacc95db-5005-477b-88d5-ecc5947beccb
      iscommand: true
      name: Set closing reason
      script: Builtin|||setIncident
      type: regular
      version: -1
    taskid: eacc95db-5005-477b-88d5-ecc5947beccb
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1870
        }
      }
  "52":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Were the rules adjusted?
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "1"
        label: ""
        labelarg:
          simple: Were the indicators adjusted?
        options: []
        optionsarg:
        - {}
        - simple: "Yes"
        - simple: "No"
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: ""
      title: Adjustments to SIEM
      totalanswers: 0
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: |
          Dear ${inputs.SocEmailAddress}
          please adjust the following rules
          ${Data for rule adjustment by the SIEM admin.Answers.0}

          And the following indicators
          ${Data for rule adjustment by the SIEM admin.Answers.1}
      cc: null
      format: ""
      methods:
      - email
      subject:
        complex:
          root: inputs.SiemAdminMailSubject
          transformers:
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.idoffense
            operator: concat
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: false
        retriescount: 2
        retriesinterval: 360
      to:
        simple: ${inputs.SiemAdminEmailAddress}
    nexttasks:
      '#none#':
      - "15"
    note: false
    quietmode: 0
    scriptarguments:
      body:
        complex:
          accessor: Answers
          root: Data for rule adjustment by the SIEM admin
          transformers:
          - operator: Stringify
          - args:
              regex:
                value:
                  simple: (.*)
              replaceWith:
                value:
                  simple: |
                    Link to offense
            operator: replaceMatch
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.linktooffense
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "\nRules to adjust - "
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Data for rule adjustment by the SIEM admin.Answers.0
            operator: concat
          - args:
              prefix: {}
              suffix:
                value:
                  simple: "\nValues to exclude - "
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: Data for rule adjustment by the SIEM admin.Answers.1
            operator: concat
      subject:
        complex:
          root: inputs.SiemAdminMailSubject
          transformers:
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: incident.idoffense
            operator: concat
      to:
        simple: ${inputs.SiemAdminEmailAddress}
    separatecontext: false
    skipunavailable: true
    task:
      brand: ""
      description: Sends an email using EWS.
      id: bb2db2a5-aa9b-403c-828b-b89904706e34
      iscommand: false
      name: Send email to SIEM admin
      type: collection
      version: -1
    taskid: bb2db2a5-aa9b-403c-828b-b89904706e34
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -60,
          "y": 2710
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "14_29_False Positive": 0.56,
      "14_45_True Positive": 0.66,
      "18_15_#default#": 0.3,
      "37_15_#default#": 0.3
    },
    "paper": {
      "dimensions": {
        "height": 5865,
        "width": 1310,
        "x": -170,
        "y": -1920
      }
    }
  }
